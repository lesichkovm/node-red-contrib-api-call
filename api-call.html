<!-- START: Script -->
<script type="text/javascript">
  RED.nodes.registerType('api call', {
    category: 'api',
    color: '#a6bbcf',
    defaults: {
      name: { value: '' },
      apiurl: { value: '', required: true },
      apikey: { value: '', required: true },
      apimethod: { value: 'post', required: true },
      field: {
        value: 'payload',
        validate: RED.validators.typedInput('fieldType'),
      },
      fieldType: { value: 'msg' },
    },
    inputs: 1,
    outputs: 1,
    icon: 'icon.svg',
    label: function () {
      return this.name || 'API'
    },
    /**
     * On edit prepare
     */
    oneditprepare: function () {
      // 1. set default field
      if (!this.field) {
        this.field = 'payload'
        $('#node-input-field').val('payload')
      }

      // 2. set default field type
      if (!this.fieldType) {
        this.fieldType = 'msg'
      }

      // 3. set field type list
      $('#node-input-field').typedInput({
        default: 'msg',
        types: ['msg', 'flow', 'global'],
        typeField: $('#node-input-fieldType'),
      })
    },
    /**
     * On edit save
     */
    oneditsave: function () {},
    /**
     * On edit resize
     */
    oneditresize: function (size) {},
  })
</script>
<!-- START: Script -->

<!-- START: Template -->
<script type="text/x-red" data-template-name="api call">
  <!-- START: Name -->
  <div class="form-row">
    <label for="node-input-name">
      <i class="fa fa-tag"></i>
      Name
    </label>
    <input type="text" id="node-input-name">
  </div>
  <!-- END: Name -->

  <!-- START: API URL -->
  <div class="form-row">
    <label for="node-input-name">
      <i class="icon-tag"></i>
      API URL
    </label>
    <input type="text" id="node-input-apiurl" placeholder="API URL">
  </div>
  <!-- END: API URL -->

  <!-- START: API Key -->
  <div class="form-row">
      <label for="node-input-name"><i class="icon-tag"></i> API Key</label>
      <input type="text" id="node-input-apikey" placeholder="API Key">
  </div>
  <!-- START: API Key -->

  <!-- <div class="form-row">
    <label for="node-input-field"><i class="fa fa-ellipsis-h"></i> <span data-i18n="template.label.property"></span></label>
    <input type="text" id="node-input-field" placeholder="payload" style="width:250px;">
    <input type="hidden" id="node-input-fieldType">
  </div> -->
  <div class="form-row">
    <label for="node-input-field">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots" viewBox="0 0 16 16">
            <path d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"/>
        </svg>
        Property
    </label>
    <input type="text" id="node-input-field" placeholder="payload" style="width:250px;">
    <input type="hidden" id="node-input-fieldType">
  </div>

  <!-- START: API Method -->
  <div class="form-row">
      <label for="">
        <i class="fa fa-code"></i>
        API Method
      </label>
      <select id="node-input-apimethod">
          <option value=""> - select method - </option>
          <option value="post">POST</option>
          <option value="get">GET</option>
          <option value="delete">DELETE</option>
          <option value="put">PUT</option>
          <option value="put">HEAD</option>
      </select>
  </div>
  <!-- END: API Method -->
</script>
<!-- END; Template -->

<!-- START: Help -->
<script type="text/x-red" data-help-name="api call">
  <p>
    A "batteries included" SQL query builder for CockroachDB, MariaDB,
    MSSQL, MySQL, PostgreSQL, SQLite3, Oracle DB, and Amazon Redshift
    designed to be flexible, portable, and fun to use.
  </p>
</script>
<!-- END: Help -->
